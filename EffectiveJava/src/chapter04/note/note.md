# 第 4 章 类和接口

## 第 17 条 使可变性最小化

为了使类成为不可变，要遵循以下五个规则：

- 不要提供任何会修改对象状态的方法。

- 保证类不会被扩展。

- 声明所有域都是 final 的。

- 声明所有域都是私有的。

- 确保对于任何可变组件的互斥访问。如果类具有指向可变对象的域，则必须确保该类的客户端无法获得指向这些对象的引用，并且永远不要用客户端提供的对象引用来初始化这样的域，也不要从任何访问方法中返回该对象引用。在构造器、访问方法和 readObject 方法中请使用保护性拷贝。

如果不改变对象的值，方法的名称可以用介词（如 plus），而不是动词（如 add）。

不可变对象真正唯一的缺点是，对于每个不同的值都需要一个单独的对象。

为了确保不可变性，类绝对不允许自身被子类化。除了“使类成为 final 的”外，还有一个更加灵活的颁发可以做到这一点，那就是让类的所有构造器都变成私有的或者包级私有的，并添加公有的静态工厂来代替公有的构造器。
